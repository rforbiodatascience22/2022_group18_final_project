---
title: "22100 - R for Bio Data Science"
subtitle : "Final project"
author: "Group 18"

date: '2022-05-09'
output: 
  ioslides_presentation:
    widescreen: true
    incremental: false
---
<style>
slides > slide {
color: #515151;
}
</style>

## Introduction
- Data
  - open source: https://doi.org/10.1371/journal.pmed.1003489
  
- Control study: PancRISK
  - Blood biomarker; plasma_CA19_9
  - Normalization; creatinine
  - Urinary biomarkers; REG1A, REG1B, LYVE1, TFF1
  - Diagnosis; control, benign, malignant

- Aim
  - Visual exploration
  - Urinary biomarker performance
  - Evaluation of diagnosis prediction

## Materials and Methods | Flow chart
<style>
slides > slide {
  background: linear-gradient(#ffffff, #ffffff 85%, #ffffff);
  background-color: white;
  }
  
img { 
  margin-top: -90px; 
  margin-left: 300px;
  width: 70%;
} 
</style>
```{r, echo=FALSE}
knitr::include_graphics('./flowchart.png')
```
## Modelling 
=======

<style>
slides > slide {
  background: linear-gradient(#ffffff, #ffffff 85%, #ffffff);
  background-color: white;
  }
img { 
 margin-top: -90px; 
  margin-left: 50px;
} 
</style>
 
<font size="2"> PCA and K-means  
</font>


```{r, fig.width = 8.5, fig.height = 6, echo = FALSE}


layout <- '
AB
'
patchwork <- wrap_plots(A=Data_onto_PCA_plot ,
           B=cumulative_variance_plot ,
           design = layout)
           

malignant_patchwork <-  wrap_plots(A=malignant_onto_PCA_plot ,
           B=malignant_cumulative_variance_plot ,
           design = layout)
  

patchwork<-patchwork + plot_annotation(
  title = "PCA results " ,
  subtitle = "The first two PCs can discriminate between patients suffering from PC from the control and benign diagnosed ones  ",
  caption= "Data from Silvana Debernardi et al" )& 
  theme(legend.position = 'bottom',
        plot.subtitle =  element_text(size=4),
        plot.title = element_text(size=8))

malignant_patchwork<- malignant_patchwork + plot_annotation(
  title = "PCA results " ,
  subtitle = "The first two PCs can't really discriminate between the 4 PDAC stages ",
  caption= "Data from Silvana Debernardi et al" )& 
  theme(legend.position = 'bottom',
        plot.subtitle =  element_text(size=4),
        plot.title = element_text(size=8))


patchwork_diagnosis_1 <-  (pl1|plasma_CA19_9_alone_plot) +
  #plot_layout(guides = 'collect')+ 
  plot_annotation(
  title = "K-means results " )&
  theme(legend.position = "bottom")

patchwork_diagnosis_2 <-(biomarkers_only_plot|complete_model_plot)+ 
  #plot_layout(guides = 'collect') + 
  plot_annotation(
  caption= "Data from Silvana Debernardi et al" )&
  theme(legend.position = "bottom")


top_patchwork <-  wrap_plots(A=patchwork ,
           B=patchwork_diagnosis_1 )
           #design = layout)
  
bottom_patchwork <-  wrap_plots(A=malignant_patchwork ,
           B=patchwork_diagnosis_2 )
           #design = layout)



top_patchwork/bottom_patchwork 


```


## Materials and Methods | Data modelling

- 1:1 Training- and validation-set split
- Seperate/Multinomial logistic regression (glm)
<br/><br/>
- Candidate 1: binary plasma CA19_9 (cutoff 37 U/ml)
- Cand. 2 (Old panel): REG1A, LYVE1, TFF1; corrected for age and creatinine
- Cand. 3 (without plasma): REG1B, LYVE1, TFF1; corrected for age and creatinine
- Cand. 4 (PancRISK): REG1B, LYVE1, TFF1 and binary plasma CA19_9; corrected for age and creatinine

## Materials and Methods | Data modelling
<style>
slides > slide {
  background: linear-gradient(#ffffff, #ffffff 85%, #ffffff);
  background-color: white;
  }
  
p { 
  margin-top: -40px; 
  margin-left: -40px;
} 
</style>
```{r, fig.width = 12, fig.height = 5.2, echo = FALSE}
(plot_roc(roc1, roc2, 
          title = "Binary CA19_9",
          caption = "Used binary plasma CA19_9\nCorrected for age\nN = 390") + 
 plot_roc(roc9, roc10, 
          title = "PancRISK (Sep. regressions)",
          caption = "Used REG1B, LYVE1, TFF1 and binary plasma CA19_9\nCorrected for age and creatinine\nN = 590\nSeperate regressions for contrasts:\nControl vs. Benign and Benign vs. Malignant")) /
(plot_roc(roc5, roc6, 
          title = "PancRISK without Plasma",
          caption = "Used REG1B, LYVE1 and TFF1\ncorrected for age and creatinine\nN = 590") + 
 plot_roc(roc7, roc8, 
          title = "PancRISK (Multinomial)",
          caption = "Used REG1B, LYVE1, TFF1 and binary plasma CA19_9\nCorrected for age and creatinine\nN = 590\nMultinom regression contrast Control vs. Benign vs. Malignant"))
```

## Results
```{r, fig.width = 6, fig.height = 6.3, echo = FALSE}
(patchwork + plot_annotation(
  title = "PCA results " ,
  subtitle = "The first two PCs can discriminate between patients suffering from PC from the control and benign diagnosed ones  ",
  caption= "Data from Silvana Debernardi et al" )& 
  theme(legend.position = 'bottom',
        plot.subtitle =  element_text(size=6),
        plot.title = element_text(size=10)))/
(malignant_patchwork + plot_annotation(
  title = "PCA results " ,
  subtitle = "The first two PCs can't really discriminate between the 4 PDAC stages ",
  caption= "Data from Silvana Debernardi et al" )& 
  theme(legend.position = 'bottom',
        plot.subtitle =  element_text(size=6),
        plot.title = element_text(size=10)))
```

- Results from modelling

## Discussion

- What we see from the model Is there any difference between our model and the model from the paper? 
- Limitation of our model 
- Any further improvements?