---
title: "Data Visualisation"
author: "Group 18"
date: '2022-04-20'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Library
```{r}
library("tidyverse")
```

# Loading of data 
```{r}
clean_data <- read.csv("../data/02_my_data_clean.tsv", sep = "\t")
```

# Cohort
```{r}
ggplot(data = clean_data, 
       mapping = aes(y = age, 
                     x = patient_cohort, 
                     color= diagnosis)) + 
  geom_boxplot()
```


```{r}
ggplot(data = clean_data, 
       mapping = aes(x = patient_cohort, 
                     y = creatinine, 
                     color = diagnosis)) + 
  geom_boxplot()
```

```{r}
ggplot(data = clean_data, 
       mapping = aes(x = patient_cohort, 
                     y = LYVE1, 
                     color = diagnosis)) + 
  geom_boxplot()
```

```{r}
ggplot(data = clean_data, 
       mapping = aes(x = patient_cohort, 
                     y = REG1B, 
                     color = diagnosis)) + 
  geom_boxplot()
```

```{r}
ggplot(data = clean_data, 
       mapping = aes(x = patient_cohort, 
                     y = TFF1, 
                     color = diagnosis)) + 
  geom_boxplot()
```

```{r}
ggplot(data = clean_data, 
       mapping = aes(x = patient_cohort, 
                     y = plasma_CA19_9, 
                     color = diagnosis)) + 
  geom_boxplot()
```

# Age Distribution 
```{r}
#clean_data %>%
#  count(age) %>%
#  ggplot(aes(x = age, y = n)) +
#  geom_col()


clean_data %>%
  ggplot(aes(x = age)) +
  geom_bar()
```

# Sex Distribution 
```{r}
clean_data %>% 
  count(sex) %>% 
  ggplot(aes(x = "", 
             y = n, 
             fill = sex)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  geom_text(aes(label = n),
            position = position_stack(vjust = 0.5)) + 
  
  theme_void() # remove background, grid, numeric labels
```

# Diagnosis
```{r}
clean_data %>% 
  count(diagnosis) %>% 
  ggplot(aes(x = "", 
             y = n, 
             fill = diagnosis)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  geom_text(aes(label = n),
            position = position_stack(vjust = 0.5)) + 
  
  theme_void() # remove background, grid, numeric labels
```

# Sample distribution between cohorts regarding protein samples taken
```{r}
data_long <- my_data_clean %>% 
  select(patient_cohort, 
         plasma_CA19_9, 
         creatinine, 
         LYVE1, 
         REG1A, 
         REG1B, 
         TFF1) %>% 
  pivot_longer(!patient_cohort, 
               names_to = "protein", 
               values_to = "expression")

data_long %>%
  group_by(patient_cohort) %>%
  ggplot(mapping = aes(y = patient_cohort, 
                       fill = patient_cohort)) +
  facet_wrap(~protein, 
             ncol = 2, 
             scales = "free") +
  geom_bar() +
  xlab("Occurence of measured protein levels per Cohort ") +
  ylab("Cohort of patients") +
  labs(title = "Sample distribution between two cohorts of patients") +
  theme_minimal() +
  theme(legend.position="none")
```








